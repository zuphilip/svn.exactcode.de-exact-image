#!/bin/bash

. config/functions

with_options="x11 evas libjpeg libtiff libpng libungif jasper openexr lcms swig"
# feature_options="debug"

PACKAGE="exact-image"
VERSION_MAJOR=0
VERSION_MINOR=1
VERSION_MICRO=0

init

prefix="/usr/local"

parse_options $*

compile c++ available.c || status_error \
	"A C++ compiler is not installed or does not work correctly.
A C++ compiler is vital for macosd - so you need to install it first"

compile c++ stl.c template.c template-specialization.c \
        partial-template-specialization.c function-template.c \
        || status_error \
	"At least one of the advanced ANSI C++ tests failed.  Since these
features are vital for macosd you need to update to a more recent compiler first."

headercheck c++ iostream string iostream sstream fstream || \
	status_error "Not all tested STL headers are present - please install them."

pkgcheck evas -config EVAS atleast 0.9.9
pkgcheck x11 compile X11 atleast 11.0

pkgcheck libjpeg header LIBJPEG cc jconfig.h
pkgcheck libtiff header LIBTIFF c++ tiff.h
pkgcheck libpng pkg-config LIBPNG atleast 1.2
pkgcheck libungif header LIBUNGIF c++ gif_lib.h
pkgcheck jasper header JASPER c++ jasper/jasper.h
pkgcheck OpenEXR pkg-config OPENEXR atleast 1.2.0
pkgcheck lcms pkg-config LCMS atleast 1.10

pkgcheck swig shell SWIG 'swig -version 2>/dev/null | sed -n "s/SWIG Version \(.*\)/\1/p"' atleast 1.3.0

save

